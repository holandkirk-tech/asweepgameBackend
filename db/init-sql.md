# (Reference) Tables created on server start

```sql
CREATE TABLE IF NOT EXISTS codes (
  id SERIAL PRIMARY KEY,
  code VARCHAR(5) NOT NULL,
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),
  expires_at TIMESTAMPTZ NOT NULL,
  is_used BOOLEAN NOT NULL DEFAULT FALSE
);
CREATE INDEX IF NOT EXISTS idx_codes_code ON codes(code);

CREATE TABLE IF NOT EXISTS spin_records (
  id SERIAL PRIMARY KEY,
  code_id INT REFERENCES codes(id) ON DELETE SET NULL,
  prize INT NOT NULL,
  outcome TEXT NOT NULL,
  created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()
);
```

## Table Descriptions

### `codes` Table
- **Purpose**: Stores 5-digit codes generated by admin
- **Key Fields**:
  - `code`: 5-digit numeric string
  - `expires_at`: Code expiration time (3 hours from creation)
  - `is_used`: Boolean flag to track if code has been used
- **Index**: Fast lookup by code value

### `spin_records` Table  
- **Purpose**: Records all spin attempts and outcomes
- **Key Fields**:
  - `code_id`: Reference to the code used
  - `prize`: Prize amount in dollars (0 = no prize)
  - `outcome`: "win" or "lose"
- **Analytics**: Can track win rates, popular codes, etc.

## Prize Distribution

Current weighted odds:
- **50%**: No prize (outcome: "lose")
- **25%**: $5 prize
- **12%**: $10 prize
- **7%**: $25 prize
- **4%**: $50 prize
- **2%**: $100 prize (Jackpot)

## Usage Flow

1. Admin generates code → Inserted into `codes` table with 3-hour expiry
2. Player submits code → Server validates from `codes` table
3. If valid → Server draws prize using weighted algorithm
4. Result recorded in `spin_records`, code marked as used in `codes`
